import{o as u,i as _,f as t,d as b,z as w,g as o,w as p,h as e,J as A,L as T,M as me,t as ge,v as N,N as v,D as pe,q as y,O as J,F as L,b as Q,P as _e,K as he,H as ve,B as X,x as ye,u as fe,E as R,Q as be,I as O,R as xe,e as S,G,S as q,T as we,n as Ce,U as Ie,V as z,W as $e,_ as ke,X as Se,Y as Ae,Z as j,$ as U}from"./index-a86022ab.js";import{_ as Te}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-3ebac268.js";import{T as Ee,a as Be}from"./TextEditor-c90c58ca.js";import{u as W}from"./error-90c51c34.js";import{d as M}from"./vuedraggable.umd-9334f31c.js";import{_ as De}from"./PageTitle.vue_vue_type_script_setup_true_lang-022e67c2.js";import{I as H}from"./iconify-6a43d462.js";import{D as Re}from"./Dropdown-068a4fad.js";import{I as Ne}from"./edit-3-c163ee41.js";import{I as He}from"./more-horizontal-b738918e.js";import{_ as P}from"./Avatar.vue_vue_type_script_setup_true_lang-f38fd5a3.js";const Le={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},qe=t("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"},null,-1),Me=t("polyline",{points:"17 21 17 13 7 13 7 21"},null,-1),Pe=t("polyline",{points:"7 3 7 8 15 8"},null,-1),Ve=[qe,Me,Pe];function Fe(r,i){return u(),_("svg",Le,[...Ve])}const Ke={name:"lucide-save",render:Fe},Oe={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},Ge=t("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"},null,-1),ze=t("path",{d:"M3 3v5h5"},null,-1),je=[Ge,ze];function Ue(r,i){return u(),_("svg",Oe,[...je])}const We={name:"lucide-rotate-ccw",render:Ue},Ye={class:"flex gap-2"},Je=b({__name:"KnowledgeBaseArticleActionsEdit",emits:["save","cancel"],setup(r,{emit:i}){const d=i,a={label:"Save",theme:"gray",variant:"solid",onClick:()=>d("save")},l={label:"Cancel",theme:"gray",variant:"subtle",onClick:()=>d("cancel")};return(m,h)=>{const n=w("Button");return u(),_("div",Ye,[o(n,A(T(l)),{prefix:p(()=>[o(e(We),{class:"h-4 w-4"})]),_:1},16),o(n,A(T(a)),{prefix:p(()=>[o(e(Ke),{class:"h-4 w-4"})]),_:1},16)])}}}),Qe={class:"flex gap-2"},Xe=b({__name:"KnowledgeBaseArticleActionsNew",emits:["create","discard"],setup(r,{emit:i}){const d=i,a={label:"Create",theme:"gray",variant:"solid",onClick:()=>d("create")},l={label:"Discard",theme:"gray",variant:"subtle",onClick:()=>d("discard")};return(m,h)=>{const n=w("Button");return u(),_("div",Qe,[o(n,A(T(l)),{prefix:p(()=>[o(e(H),{icon:"lucide:x",class:"h-4 w-4"})]),_:1},16),o(n,A(T(a)),{prefix:p(()=>[o(e(H),{icon:"lucide:check",class:"h-4 w-4"})]),_:1},16)])}}}),Ze={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},et=me('<path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path><line x1="10" x2="10" y1="11" y2="17"></line><line x1="14" x2="14" y1="11" y2="17"></line>',5),tt=[et];function at(r,i){return u(),_("svg",Ze,[...tt])}const ot={name:"lucide-trash-2",render:at},st={class:"flex gap-2"},rt=b({__name:"KnowledgeBaseArticleActionsView",props:{status:{type:String,required:!1,default:"Draft"}},emits:["delete","toggleEditMode","toggleStatus"],setup(r,{emit:i}){const d=r,a=i,l=ge(d,"status"),m=N(!1),h=v(()=>({label:l.value==="Published"?"Unpublish":"Publish",theme:"gray",variant:"solid",onClick:()=>a("toggleStatus")})),n=[{label:"Edit",icon:Ne,onClick:()=>a("toggleEditMode")},{label:"Delete",icon:ot,onClick:()=>m.value=!m.value}],C={title:"Delete",message:"Are you sure you want to delete? This action can not be reversed",icon:{name:"alert-triangle",appearance:"warning"},actions:[{label:"Confirm",theme:"red",variant:"solid",onClick:()=>a("delete")}]};return(I,E)=>{const B=w("Button");return u(),_("div",st,[o(B,A(T(h.value)),null,16),o(e(Re),{options:n},{default:p(()=>[o(B,{theme:"gray",variant:"ghost"},{icon:p(()=>[o(e(He),{class:"h-4 w-4"})]),_:1})]),_:1}),o(e(pe),{modelValue:m.value,"onUpdate:modelValue":E[0]||(E[0]=$=>m.value=$),options:C},null,8,["modelValue"])])}}}),nt={class:"mb-4.5 flex items-center justify-between"},it={class:"flex items-center gap-2"},lt={class:"text-base text-gray-800"},ct={class:"flex items-center gap-2 text-sm text-gray-600"},ut=t("div",{class:"text-gray-600"},"Created",-1),dt={class:"text-gray-800"},mt=t("div",{class:"text-base text-gray-300"},"|",-1),gt=t("div",{class:"text-gray-600"},"Modified",-1),pt={class:"text-gray-800"},_t={class:"border-b pb-3"},ht=b({__name:"KnowledgeBaseArticleTopEdit",props:{categoryName:{},subCategoryName:{},title:{},authorFullname:{},authorImage:{},creation:{},modified:{},likes:{},dislikes:{}},emits:["update:title"],setup(r,{emit:i}){const d=i;return(a,l)=>(u(),_(L,null,[t("div",nt,[t("div",it,[o(e(P),{label:a.authorFullname,image:a.authorImage},null,8,["label","image"]),t("div",lt,y(a.authorFullname),1)]),t("div",ct,[ut,t("div",dt,y(e(M).tz(a.creation).fromNow()),1),mt,gt,t("div",pt,y(e(M).tz(a.modified).fromNow()),1)])]),t("div",_t,[o(e(J),{value:a.title,type:"text",onChange:l[0]||(l[0]=m=>d("update:title",m.target.value))},null,8,["value"])])],64))}}),vt={class:"mb-4.5 flex items-center justify-between"},yt={class:"flex items-center gap-2"},ft={class:"text-base text-gray-800"},bt={class:"border-b pb-3"},xt=b({__name:"KnowledgeBaseArticleTopNew",props:{title:{},authorFullname:{},authorImage:{}},emits:["update:title"],setup(r,{emit:i}){const d=i;return(a,l)=>(u(),_(L,null,[t("div",vt,[t("div",yt,[o(e(P),{label:a.authorFullname,image:a.authorImage},null,8,["label","image"]),t("div",ft,y(a.authorFullname),1)])]),t("div",bt,[o(e(J),{type:"text",placeholder:"Title",onChange:l[0]||(l[0]=m=>d("update:title",m.target.value))})])],64))}}),wt={class:"mb-8 flex items-center gap-1.5"},Ct={class:"border-b pb-3"},It={class:"text-3xl font-semibold text-gray-900"},$t=b({__name:"KnowledgeBaseArticleTopPublic",props:{subCategoryName:{type:String,required:!0},subCategoryId:{type:String,required:!0},title:{type:String,required:!0}},setup(r){const i=r,d=Q(),{subCategoryId:a}=_e(i);function l(){d.push({name:ve,params:{categoryId:a.value}})}return(m,h)=>{const n=w("RouterLink");return u(),_(L,null,[t("div",wt,[o(n,{to:{name:e(he)}},{default:p(()=>[o(e(H),{icon:"lucide:home",class:"h-4 w-4 text-gray-800"})]),_:1},8,["to"]),o(e(H),{icon:"lucide:chevron-right",class:"h-4 w-4 text-gray-600"}),t("div",{class:"cursor-pointer text-base font-medium text-gray-800",onClick:l},y(r.subCategoryName),1)]),t("div",Ct,[t("div",It,y(r.title),1)])],64)}}}),kt={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},St=t("circle",{cx:"12.1",cy:"12.1",r:"1"},null,-1),At=[St];function Tt(r,i){return u(),_("svg",kt,[...At])}const Y={name:"lucide-dot",render:Tt},Et={class:"mb-4.5 flex items-center justify-between"},Bt={class:"flex items-center gap-1"},Dt={class:"flex items-center gap-2"},Rt={class:"text-base text-gray-800"},Nt={class:"text-xs text-gray-800"},Ht={class:"border-b pb-3"},Lt={class:"text-3xl font-semibold text-gray-900"},qt=b({__name:"KnowledgeBaseArticleTopView",props:{categoryName:{type:String,required:!0},categoryId:{type:String,required:!0},subCategoryName:{type:String,required:!0},subCategoryId:{type:String,required:!0},title:{type:String,required:!0},status:{type:String,required:!0},authorFullname:{type:String,required:!0},authorImage:{type:String,required:!0},creation:{type:String,required:!0},modified:{type:String,required:!0}},setup(r){return(i,d)=>{const a=w("Badge");return u(),_(L,null,[t("div",Et,[t("div",Bt,[t("div",Dt,[o(e(P),{label:r.authorFullname,image:r.authorImage},null,8,["label","image"]),t("div",Rt,y(r.authorFullname),1)]),o(e(Y),{class:"h-4 w-4 text-gray-600"}),t("div",Nt,y(e(M)(r.creation).short()),1),o(e(Y),{class:"h-4 w-4 text-gray-600"}),o(a,{theme:r.status==="Published"?"green":"orange",variant:"subtle"},{default:p(()=>[X(y(r.status),1)]),_:1},8,["theme"])])]),t("div",Ht,[t("div",Lt,y(r.title),1)])],64)}}}),Mt={class:"flex h-full flex-col overflow-hidden"},Pt={class:"overflow-auto"},Vt={class:"container m-auto my-12"},Zt=b({__name:"KnowledgeBaseArticle",props:{articleId:{type:String,required:!0}},setup(r){const i=r;ye(()=>{setTimeout(()=>{d()},100)});function d(){const s=window.location.hash;if(!s)return;const g=document.querySelector(s);g&&g.scrollIntoView({behavior:"smooth"})}const a=Ie(),l=Q(),m=fe(),h=i.articleId==="new",n=N(h),C=v(()=>a.query.category),I=v(()=>a.query.subCategory),E=v(()=>{const s=[{label:f.value.categoryName,route:{name:Ae,params:{categoryId:f.value.categoryId}}},{label:f.value.subCategoryName,route:{name:j,params:{categoryId:f.value.categoryId,subCategoryId:f.value.subCategoryId}}}];return h||s.push({label:c.data?.title,route:{name:z,params:{articleId:c.data?.name},query:{category:f.value.categoryId,subCategory:f.value.subCategoryId}}}),s}),B=v(()=>n.value?"Write something...":"Content is empty"),$=N(""),k=N(""),Z=v(()=>h?Xe:n.value?Je:rt),ee=v(()=>a.meta.public?$t:h?xt:n.value?ht:qt),c=R({url:"helpdesk.helpdesk.doctype.hd_article.api.get_article",params:{name:i.articleId},onSuccess(s){k.value=s.title,be("article_viewed",{data:{user:m.userId,article:s.name,title:s.title}})},auto:!h}),te=O({doctype:"HD Article Category",name:C.value,auto:!0}),ae=O({doctype:"HD Article Category",name:I.value,auto:!0}),f=v(()=>({authorFullname:c.data?.author.full_name||m.userName,authorImage:c.data?.author.user_image||m.userImage,categoryId:C.value,categoryName:c.data?.category.category_name||te?.doc?.category_name,creation:c.data?.creation,modified:c.data?.modified,status:c.data?.status,subCategoryId:I.value,subCategoryName:c.data?.sub_category.category_name||ae?.doc?.category_name,title:c.data?.title})),oe=R({url:"frappe.client.insert",makeParams(){return{doc:{doctype:"HD Article",category:I.value,title:k.value,content:$.value}}},validate(s){if(!s.doc.title)throw"Title is required";if(!s.doc.content)throw"Content is required"},onSuccess(s){l.push({name:z,params:{articleId:s.name}})},onError:W({title:"Error creating article"})}),V=R({url:"frappe.client.set_value",onSuccess(){c.reload(),$e({title:"Article updated",icon:"check",iconClasses:"text-green-500"})},onError:W({title:"Error updating article"})}),se=R({url:"frappe.client.delete",makeParams(){return{doctype:"HD Article",name:i.articleId}},onSuccess(){l.replace(F.value)}}),re=U(()=>{V.submit({doctype:"HD Article",name:c.data.name,fieldname:{content:$.value,title:k.value}})},300),ne=U(()=>{const s=c.data.status==="Published"?"Draft":"Published";V.submit({doctype:"HD Article",name:c.data.name,fieldname:"status",value:s})},300),F=v(()=>({name:j,params:{categoryId:C.value,subCategoryId:I.value}})),ie=["Paragraph",["Heading 2","Heading 3","Heading 4","Heading 5","Heading 6"],"Separator","Bold","Italic","Separator","Bullet List","Numbered List","Separator","Align Left","Align Center","Align Right","FontColor","Separator","Image","Video","Link","Blockquote","Code","Horizontal Rule",["InsertTable","AddColumnBefore","AddColumnAfter","DeleteColumn","AddRowBefore","AddRowAfter","DeleteRow","MergeCells","SplitCell","ToggleHeaderColumn","ToggleHeaderRow","ToggleHeaderCell","DeleteTable"]],le=xe.create({name:"preserveIds",addGlobalAttributes(){return[{types:["heading"],attributes:{id:{default:null,parseHTML:s=>s.getAttribute("id"),renderHTML:s=>s.id?{id:s.id}:{}}}}]}}),ce=v(()=>ue(c.data?.content));function ue(s){const D=new DOMParser().parseFromString(s,"text/html");return D.querySelectorAll("h2, h3, h4, h5, h6").forEach(K=>{const de=K.textContent.trim().replace(/[^a-z0-9]+/gi,"-").toLowerCase();K.setAttribute("id",de)}),D.body.innerHTML}return(s,g)=>{const D=w("RouterLink");return u(),_("div",Mt,[e(a).meta.public?q("",!0):(u(),S(e(De),{key:0},{title:p(()=>[o(e(Te),{items:E.value},null,8,["items"])]),right:p(()=>[(u(),S(G(Z.value),{status:e(c).data?.status,onCancel:g[0]||(g[0]=()=>e(c).reload().then(n.value=!n.value)),onCreate:e(oe).submit,onDelete:e(se).submit,onDiscard:g[1]||(g[1]=x=>e(l).push(F.value)),onSave:e(re),onToggleEditMode:g[2]||(g[2]=x=>n.value=!n.value),onToggleStatus:e(ne)},null,40,["status","onCreate","onDelete","onSave","onToggleStatus"]))]),_:1})),t("div",Pt,[t("div",Vt,[o(e(Be),{content:ce.value,editable:n.value,placeholder:B.value,extensions:[e(le)],class:Ce(["rounded",{shadow:n.value,"p-4":n.value}]),"editor-class":"prose-f",onChange:g[4]||(g[4]=x=>$.value=x)},{top:p(()=>[(u(),S(G(ee.value),we({title:k.value,"onUpdate:title":g[3]||(g[3]=x=>k.value=x)},f.value),null,16,["title"])),n.value?(u(),S(e(Ee),{key:0,class:"-ml-1",buttons:ie})):q("",!0)]),_:1},8,["content","editable","placeholder","extensions","class"]),e(a).meta.public?(u(),S(D,{key:0,to:{name:e(Se)}},{default:p(()=>[o(e(ke),{label:"Still need help? Create a ticket",size:"md",theme:"gray",variant:"solid"},{suffix:p(()=>[X(" → ")]),_:1})]),_:1},8,["to"])):q("",!0)])])])}}});export{Zt as default};
//# sourceMappingURL=KnowledgeBaseArticle-0ab3212b.js.map
