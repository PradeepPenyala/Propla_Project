import{o,i as l,f as e,aj as X,v as D,ao as ve,N as M,u as H,E as T,d as A,ap as xe,z as y,h as s,g as d,w as E,F as L,r as B,e as k,T as J,q as $,S as x,aq as Q,a as G,n as V,M as we,ar as be,a5 as U,W as R,B as O,c as ke,as as Y,at as ye,G as q,D as $e,an as Ce,ai as Se,au as Le,ak as Ae,av as Ee,aw as Be,C as ee,U as De,b as te,ax as Me,ay as Ie,az as Ve,aA as Re,aB as Te,am as Ne,aC as Fe}from"./index-a86022ab.js";import{d as je,L as Pe,a as Ue,b as Oe,C as He}from"./vuedraggable.umd-9334f31c.js";import{I as ze}from"./x-948a4c6e.js";import{u as W}from"./error-90c51c34.js";import{c as qe}from"./listManager-63aba0ed.js";import"./iconify-6a43d462.js";import{_ as Ge}from"./UserAvatar.vue_vue_type_script_setup_true_lang-a7059022.js";import{_ as P}from"./SidebarLink.vue_vue_type_script_setup_true_lang-a25d88ee.js";import{D as Ze}from"./Dropdown-068a4fad.js";import{_ as Ke}from"./BrandLogo.vue_vue_type_script_setup_true_lang-7b2cc865.js";import{L as oe,a as ne,b as ae,c as se,d as ie,e as le,I as ce}from"./yandex-0c7818c3.js";import{_ as Ye}from"./plus-3ad50efe.js";import{_ as We}from"./Avatar.vue_vue_type_script_setup_true_lang-f38fd5a3.js";import{F as Xe}from"./FileUploader-c45cb8d3.js";const Je={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},Qe=e("path",{d:"M18 6 7 17l-5-5"},null,-1),et=e("path",{d:"m22 10-7.5 7.5L13 16"},null,-1),tt=[Qe,et];function ot(r,t){return o(),l("svg",Je,[...tt])}const nt={name:"lucide-check-check",render:ot},Z=X("sidebar",()=>{const r=D(!0),t=ve("sidebar_is_expanded",!0),n=M(()=>t.value?"224px":"50px");function i(c){r.value=c??!r.value}function a(c){t.value=c??!t.value}return{isExpanded:t,isOpen:r,toggle:i,toggleExpanded:a,width:n}}),re=X("notification",()=>{const r=H(),t=D(!1),n=qe({doctype:"HD Notification",cache:"Notifications",filters:{user_to:["=",r.userId]},fields:["creation","name","notification_type","read","reference_comment","reference_ticket","user_from","user_to"],orderBy:"creation desc",auto:!0}),i=T({url:"helpdesk.helpdesk.doctype.hd_notification.utils.clear",auto:!1,onSuccess:()=>n.reload(),onError:W()}),a=m=>{T({url:"helpdesk.helpdesk.doctype.hd_notification.utils.clear",auto:!0,params:{ticket:m},onSuccess:()=>n.reload(),onError:W()})},c=M(()=>n.data||[]),_=M(()=>c.value.filter(m=>!m.read).length);function f(){t.value=!t.value}return{clear:i,data:c,toggle:f,read:a,unread:_,visible:t}}),at={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-5 py-2.5"},st=e("span",{class:"text-lg font-medium"},"Notifications",-1),it={class:"divide-y text-base"},lt={class:"mb-2 leading-5"},ct={class:"space-x-1 text-gray-700"},rt={class:"font-medium text-gray-900"},dt={key:0},ut={key:1},_t={key:2},mt={class:"font-medium text-gray-900"},pt={class:"flex items-center gap-2"},ht={class:"text-sm text-gray-600"},gt={key:0,class:"h-1.5 w-1.5 rounded-full bg-gray-900"},ft=A({__name:"Notifications",setup(r){const t=re(),n=Z(),i=D(null);xe(i,()=>{t.visible&&t.toggle()});function a(c){switch(c.notification_type){case"Mention":return{name:"TicketAgent",params:{ticketId:c.reference_ticket},hash:"#"+c.reference_comment};case"Assignment":case"Reaction":return{name:"TicketAgent",params:{ticketId:c.reference_ticket}}}}return(c,_)=>{const f=nt,m=y("Button"),b=ze,p=y("RouterLink");return s(t).visible?(o(),l("span",{key:0,ref_key:"target",ref:i,class:"fixed z-10 h-screen overflow-auto bg-white",style:Q({"box-shadow":"8px 0px 8px rgba(0, 0, 0, 0.1)","max-width":"350px","min-width":"350px",left:s(n).width})},[e("div",at,[st,e("span",null,[d(m,{theme:"blue",variant:"ghost",onClick:_[0]||(_[0]=()=>s(t).clear.submit())},{icon:E(()=>[d(f,{class:"h-4 w-4"})]),_:1}),d(m,{theme:"gray",variant:"ghost",onClick:_[1]||(_[1]=()=>s(t).toggle())},{icon:E(()=>[d(b,{class:"h-4 w-4"})]),_:1})])]),e("div",it,[(o(!0),l(L,null,B(s(t).data,h=>(o(),k(p,{key:h.name,class:"flex cursor-pointer items-start gap-3.5 px-5 py-2.5 hover:bg-gray-100",to:a(h),onClick:()=>{s(t).toggle(),s(t).read(h.reference_ticket)}},{default:E(()=>[d(s(Ge),J({ref_for:!0},h.user_from),null,16),e("span",null,[e("div",lt,[e("span",ct,[e("span",rt,$(h.user_from.name),1),h.notification_type==="Mention"?(o(),l("span",dt,"mentioned you in ticket")):x("",!0),h.notification_type==="Assignment"?(o(),l("span",ut,"assigned you a ticket")):x("",!0),h.notification_type==="Reaction"?(o(),l("span",_t,"has reopened the ticket")):x("",!0),e("span",mt,$(h.reference_ticket),1)])]),e("div",pt,[e("div",ht,$(s(je).tz(h.creation).fromNow()),1),h.read?x("",!0):(o(),l("div",gt))])])]),_:2},1032,["to","onClick"]))),128))])],4)):x("",!0)}}}),vt=e("div",{class:"text-base font-medium leading-none text-gray-900"}," Helpdesk ",-1),xt={class:"mt-1 text-sm leading-none text-gray-700"},wt=A({__name:"UserMenu",props:{options:{type:Array,required:!0}},setup(r){G();const t=H(),n=Z();return(i,a)=>{const c=y("FeatherIcon");return o(),k(s(Ze),{options:r.options},{default:E(({open:_})=>[e("button",{class:V(["flex h-12 items-center rounded-md py-2 duration-300 ease-in-out",s(n).isExpanded?_?"w-52 bg-white px-2 shadow-sm":"w-52 px-2 hover:bg-gray-200":"w-auto px-0"])},[d(Ke),e("div",{class:V(["flex flex-1 flex-col text-left duration-300 ease-in-out",s(n).isExpanded?"ml-2 w-auto opacity-100":"ml-0 w-0 overflow-hidden opacity-0"])},[vt,e("div",xt,$(s(t).userName),1)],2),e("div",{class:V(["duration-300 ease-in-out",s(n).isExpanded?"ml-2 w-auto opacity-100":"ml-0 w-0 overflow-hidden opacity-0"])},[d(c,{name:"chevron-down",class:"h-4 w-4 text-gray-600","aria-hidden":"true"})],2)],2)]),_:1},8,["options"])}}}),bt={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},kt=e("path",{d:"m9 6-6 6 6 6"},null,-1),yt=e("path",{d:"M3 12h14"},null,-1),$t=e("path",{d:"M21 19V5"},null,-1),Ct=[kt,yt,$t];function St(r,t){return o(),l("svg",bt,[...Ct])}const Lt={name:"lucide-arrow-left-from-line",render:St},At={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},Et=e("path",{d:"M3 5v14"},null,-1),Bt=e("path",{d:"M21 12H7"},null,-1),Dt=e("path",{d:"m15 18 6-6-6-6"},null,-1),Mt=[Et,Bt,Dt];function It(r,t){return o(),l("svg",At,[...Mt])}const Vt={name:"lucide-arrow-right-from-line",render:It},Rt={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},Tt=e("path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973"},null,-1),Nt=e("path",{d:"m13 12-3 5h4l-3 5"},null,-1),Ft=[Tt,Nt];function jt(r,t){return o(),l("svg",Rt,[...Ft])}const Pt={name:"lucide-cloud-lightning",render:jt},Ut={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},Ot=we('<path d="M16 18a4 4 0 0 0-8 0"></path><circle cx="12" cy="11" r="3"></circle><rect width="18" height="18" x="3" y="4" rx="2"></rect><line x1="8" x2="8" y1="2" y2="4"></line><line x1="16" x2="16" y1="2" y2="4"></line>',5),Ht=[Ot];function zt(r,t){return o(),l("svg",Ut,[...Ht])}const qt={name:"lucide-contact-2",render:zt},Gt={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},Zt=e("polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12"},null,-1),Kt=e("path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"},null,-1),Yt=[Zt,Kt];function Wt(r,t){return o(),l("svg",Gt,[...Yt])}const Xt={name:"lucide-inbox",render:Wt},Jt={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},Qt=e("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"},null,-1),eo=e("circle",{cx:"12",cy:"7",r:"4"},null,-1),to=[Qt,eo];function oo(r,t){return o(),l("svg",Jt,[...to])}const no={name:"lucide-user",render:oo},ao={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},so=e("path",{d:"M18 20a6 6 0 0 0-12 0"},null,-1),io=e("circle",{cx:"12",cy:"10",r:"4"},null,-1),lo=e("circle",{cx:"12",cy:"12",r:"10"},null,-1),co=[so,io,lo];function ro(r,t){return o(),l("svg",ao,[...co])}const uo={name:"lucide-user-circle-2",render:ro},_o={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},mo=e("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"},null,-1),po=e("circle",{cx:"9",cy:"7",r:"4"},null,-1),ho=e("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"},null,-1),go=e("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"},null,-1),fo=[mo,po,ho,go];function vo(r,t){return o(),l("svg",_o,[...fo])}const xo={name:"lucide-users",render:vo},wo={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},bo=e("rect",{width:"20",height:"16",x:"2",y:"4",rx:"2"},null,-1),ko=e("path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"},null,-1),yo=[bo,ko];function $o(r,t){return o(),l("svg",wo,[...yo])}const Co={name:"lucide-mail",render:$o},So={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Lo=e("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[e("path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10l-3.1-3.1a2 2 0 0 0-2.814.014L6 21"}),e("path",{d:"m14 19.5l3-3l3 3M17 22v-5.5"}),e("circle",{cx:"9",cy:"9",r:"2"})],-1),Ao=[Lo];function Eo(r,t){return o(),l("svg",So,[...Ao])}const Bo={name:"lucide-image-up",render:Eo},de="/assets/helpdesk/desk/assets/frappe-mail-579163d7.svg",ue=[{label:"Account Name",name:"email_account_name",type:"text",placeholder:"Support / Sales"},{label:"Email ID",name:"email_id",type:"email",placeholder:"johndoe@example.com"}],_e=[{label:"Enable Incoming",name:"enable_incoming",type:"checkbox",description:"If enabled, tickets can be created from the incoming emails on this account."},{label:"Enable Outgoing",name:"enable_outgoing",type:"checkbox",description:"If enabled, outgoing emails can be sent from this account."},{label:"Default Incoming",name:"default_incoming",type:"checkbox",description:"If enabled, all replies to your company (eg: replies@yourcomany.com) will come to this account. Note: Only one account can be default incoming."},{label:"Default Outgoing",name:"default_outgoing",type:"checkbox",description:"If enabled, all outgoing emails will be sent from this account. Note: Only one account can be default outgoing."}],me=[...ue,{label:"Password",name:"password",type:"password",placeholder:"********"}],pe=[...ue,{label:"API Key",name:"api_key",type:"text",placeholder:"********"},{label:"API Secret",name:"api_secret",type:"password",placeholder:"********"}],he=[{name:"Frappe Mail",icon:de,info:"Setting up Frappe Mail requires you to have an API key and API Secret of your email account. Read more ",link:"https://yandex.com/support/id/authorization/app-passwords.html",custom:!0},{name:"GMail",icon:oe,info:`Setting up GMail requires you to enable two factor authentication
		  and app specific passwords. Read more`,link:"https://support.google.com/accounts/answer/185833",custom:!1},{name:"Outlook",icon:ne,info:`Setting up Outlook requires you to enable two factor authentication
		  and app specific passwords. Read more`,link:"https://support.microsoft.com/en-us/account-billing/how-to-get-and-use-app-passwords-5896ed9b-4263-e681-128a-a6f2979a7944",custom:!1},{name:"Sendgrid",icon:ae,info:`Setting up Sendgrid requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://sendgrid.com/docs/ui/account-and-settings/two-factor-authentication/",custom:!1},{name:"SparkPost",icon:se,info:`Setting up SparkPost requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://support.sparkpost.com/docs/my-account-and-profile/enabling-two-factor-authentication",custom:!1},{name:"Yahoo",icon:ie,info:`Setting up Yahoo requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://help.yahoo.com/kb/SLN15241.html",custom:!1},{name:"Yandex",icon:le,info:`Setting up Yandex requires you to enable two factor authentication
		  and app specific passwords. Read more `,link:"https://yandex.com/support/id/authorization/app-passwords.html",custom:!1}],ge={GMail:oe,Outlook:ne,Sendgrid:ae,SparkPost:se,Yahoo:ie,Yandex:le,"Frappe Mail":de};function fe(r,t){if(!r.email_account_name)return"Account name is required";if(!r.email_id)return"Email ID is required";if(!be(r.email_id))return"Invalid email ID";if(!t&&!r.password)return"Password is required";if(t){if(!r.api_key)return"API Key is required";if(!r.api_secret)return}return""}const Do=["src"],Mo={key:0,class:"text-center text-xs text-gray-700"},K=A({__name:"EmailProviderIcon",props:{serviceName:{default:""},logo:{default:""},selected:{type:Boolean,default:!1}},setup(r){return(t,n)=>(o(),l(L,null,[e("div",{class:V(["flex h-10 w-10 cursor-pointer items-center justify-center rounded-xl bg-gray-100 hover:bg-gray-200",{"ring-2 ring-blue-500":t.selected}])},[e("img",{src:t.logo,class:"h-6 w-6"},null,8,Do)],2),t.serviceName?(o(),l("p",Mo,$(t.serviceName),1)):x("",!0)],64))}}),Io={class:"flex h-full flex-col gap-4"},Vo=e("div",{role:"heading","aria-level":"1",class:"flex flex-col gap-1"},[e("h5",{class:"text-lg font-semibold"},"Setup Email"),e("p",{class:"text-sm text-gray-600"}," Choose the email service provider you want to configure. ")],-1),Ro={class:"flex flex-wrap items-center gap-4"},To=["onClick"],No={key:0,class:"flex flex-col gap-4"},Fo={class:"flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200"},jo={class:"text-wrap text-xs text-gray-700"},Po=["href"],Uo={class:"flex flex-col gap-4"},Oo={class:"grid grid-cols-1 gap-4"},Ho={class:"grid grid-cols-2 gap-4"},zo={class:"text-xs text-gray-500"},qo={key:1,class:"mt-auto flex justify-between"},Go=A({__name:"EmailAdd",emits:["update:step"],setup(r,{emit:t}){const n=t,i=U({service:"",email_account_name:"",email_id:"",password:"",api_key:"",api_secret:"",enable_incoming:!1,enable_outgoing:!1,default_incoming:!1,default_outgoing:!1}),a=D(null),c=M(()=>a.value.custom?pe:me);function _(p){a.value=p,i.service=p.name}const f=T({url:"helpdesk.api.settings.create_email_account",makeParams:p=>({...p}),onSuccess:()=>{R({title:"Email account created successfully",icon:"check",iconClasses:"text-green-600"}),n("update:step","email-list")},onError:()=>{m.value="Failed to create email account, Invalid credentials"}}),m=D("");function b(){m.value=fe(i,a.value.custom),!m.value&&f.submit({data:i})}return(p,h)=>{const C=y("FormControl"),v=y("ErrorMessage"),S=y("Button");return o(),l("div",Io,[Vo,e("div",Ro,[(o(!0),l(L,null,B(s(he),u=>(o(),l("div",{key:u.name,class:"min-w-3 mt-4 flex flex-col items-center gap-1",onClick:w=>_(u)},[d(K,{"service-name":u.name,logo:u.icon,selected:a.value?.name===u?.name},null,8,["service-name","logo","selected"])],8,To))),128))]),a.value?(o(),l("div",No,[e("div",Fo,[d(s(ce),{class:"h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-blue-500"}),e("div",jo,[O($(a.value.info)+" ",1),e("a",{href:a.value.link,target:"_blank",class:"text-blue-500 underline"},"here",8,Po),O(" . ")])]),e("div",Uo,[e("div",Oo,[(o(!0),l(L,null,B(c.value,u=>(o(),l("div",{key:u.name,class:"flex flex-col gap-1"},[d(C,{modelValue:i[u.name],"onUpdate:modelValue":w=>i[u.name]=w,label:u.label,name:u.name,type:u.type,placeholder:u.placeholder},null,8,["modelValue","onUpdate:modelValue","label","name","type","placeholder"])]))),128))]),e("div",Ho,[(o(!0),l(L,null,B(s(_e),u=>(o(),l("div",{key:u.name,class:"flex flex-col gap-1"},[d(C,{modelValue:i[u.name],"onUpdate:modelValue":w=>i[u.name]=w,label:u.label,name:u.name,type:u.type},null,8,["modelValue","onUpdate:modelValue","label","name","type"]),e("p",zo,$(u.description),1)]))),128))]),m.value?(o(),k(v,{key:0,class:"ml-1",message:m.value},null,8,["message"])):x("",!0)])])):x("",!0),a.value?(o(),l("div",qo,[d(S,{label:"Back",theme:"gray",variant:"outline",disabled:s(f).loading,onClick:h[0]||(h[0]=u=>n("update:step","email-list"))},null,8,["disabled"]),d(S,{label:"Create",variant:"solid",loading:s(f).loading,onClick:b},null,8,["loading"])])):x("",!0)])}}}),Zo={class:"flex justify-between items-center border-b border-gray-200 p-2 cursor-pointer"},Ko={class:"flex justify-between items-center gap-2"},Yo={class:"text-gray-700 font-semibold"},Wo={class:"text-sm text-gray-500"},Xo=A({__name:"EmailAccountCard",props:{emailAccount:{}},setup(r){const t=r,n=M(()=>t.emailAccount.default_incoming&&t.emailAccount.default_outgoing?["Default Sending and Inbox",t.emailAccount.enable_incoming&&t.emailAccount.enable_outgoing?"blue":"gray"]:t.emailAccount.default_incoming?["Default Inbox",t.emailAccount.enable_incoming?"blue":"gray"]:t.emailAccount.default_outgoing?["Default Sending",t.emailAccount.enable_outgoing?"blue":"gray"]:["Inbox",t.emailAccount.enable_incoming?"blue":"gray"]);return(i,a)=>{const c=y("Badge");return o(),l("div",Zo,[e("div",Ko,[d(K,{logo:s(ge)[i.emailAccount.service]},null,8,["logo"]),e("div",null,[e("p",Yo,$(i.emailAccount.email_account_name),1),e("div",Wo,$(i.emailAccount.email_id),1)])]),e("div",null,[d(c,{variant:"subtle",label:n.value[0],theme:n.value[1]},null,8,["label","theme"])])])}}}),Jo={class:"flex items-center justify-between"},Qo=e("h1",{class:"text-lg font-semibold"},"Email Accounts",-1),en={key:0,class:"mt-4"},tn={key:1,class:"flex items-center justify-center h-64 text-gray-500"},on=A({__name:"EmailAccountList",emits:["update:step"],setup(r,{emit:t}){const n=t,i=ke({doctype:"Email Account",cache:!0,fields:["*"],filters:{email_id:["Not Like","%example%"]},pageLength:10,auto:!0,onSuccess:a=>{a.forEach(c=>{c.enable_incoming=!!c.enable_incoming,c.enable_outgoing=!!c.enable_outgoing,c.default_incoming=!!c.default_incoming,c.default_outgoing=!!c.default_outgoing})}});return(a,c)=>{const _=Ye,f=y("Button");return o(),l("div",null,[e("div",Jo,[Qo,d(f,{label:"Add Account",theme:"gray",variant:"solid",onClick:c[0]||(c[0]=m=>n("update:step","email-add"))},{prefix:E(()=>[d(_,{class:"h-4 w-4"})]),_:1})]),!s(i).loading&&s(i).data?.length?(o(),l("div",en,[(o(!0),l(L,null,B(s(i).data,m=>(o(),l("div",{key:m.name},[d(Xo,{emailAccount:m,onClick:b=>n("update:step","email-edit",m)},null,8,["emailAccount","onClick"])]))),128))])):(o(),l("div",tn," Please add an email account to continue. "))])}}}),nn={class:"flex h-full flex-col gap-4"},an=e("div",{role:"heading","aria-level":"1",class:"flex gap-1 justify-between"},[e("h5",{class:"text-lg font-semibold"},"Edit Email")],-1),sn={class:"w-fit"},ln={class:"flex items-center gap-2 rounded-md p-2 ring-1 ring-gray-200"},cn={class:"text-wrap text-xs text-gray-700"},rn=["href"],dn={class:"flex flex-col gap-4"},un={class:"grid grid-cols-1 gap-4"},_n={class:"grid grid-cols-2 gap-4"},mn={class:"text-xs text-gray-500"},pn={class:"mt-auto flex justify-between"},hn=A({__name:"EmailEdit",props:{accountData:{default:null}},emits:["update:step"],setup(r,{emit:t}){const n=r,i=t,a=U({email_account_name:n.accountData.email_account_name||"",service:n.accountData.service||"",email_id:n.accountData.email_id||"",api_key:n.accountData?.api_key||null,api_secret:n.accountData?.api_secret||null,password:n.accountData?.password||null,enable_incoming:n.accountData.enable_incoming||!1,enable_outgoing:n.accountData.enable_outgoing||!1,default_outgoing:n.accountData.default_outgoing||!1,default_incoming:n.accountData.default_incoming||!1}),c={description:"To know more about setting up email accounts, click",link:"https://docs.erpnext.com/docs/user/manual/en/email-account"},_=M(()=>he.find(w=>w.name===n.accountData.service).custom),f=M(()=>_.value?pe:me),m=D(""),b=D(!1);async function p(){if(m.value=fe(a,_.value),m.value)return;const w={...n.accountData},I={...a},N=w.email_account_name!==I.email_account_name;delete w.email_account_name,delete I.email_account_name;const F=h.value,j=I;if(!N&&!F){R({title:"No changes made",icon:"info",iconClasses:"text-blue-600"});return}if(N)try{b.value=!0,await C(),S()}catch{u()}if(F)try{b.value=!0,await v(j),S()}catch{u()}}const h=M(()=>a.email_id!==n.accountData.email_id||a.api_key!==n.accountData.api_key||a.api_secret!==n.accountData.api_secret||a.password!==n.accountData.password||a.enable_incoming!==n.accountData.enable_incoming||a.enable_outgoing!==n.accountData.enable_outgoing||a.default_outgoing!==n.accountData.default_outgoing||a.default_incoming!==n.accountData.default_incoming);async function C(){return await Y("frappe.client.rename_doc",{doctype:"Email Account",old_name:n.accountData.email_account_name,new_name:a.email_account_name})}async function v(w){return(await Y("frappe.client.set_value",{doctype:"Email Account",name:a.email_account_name,fieldname:w})).name}function S(){i("update:step","email-list"),R({title:"Email account updated successfully",icon:"check",iconClasses:"text-green-600"})}function u(){b.value=!1,m.value="Failed to update email account, Invalid credentials"}return(w,I)=>{const N=y("FormControl"),F=y("ErrorMessage"),j=y("Button");return o(),l("div",nn,[an,e("div",sn,[d(K,{logo:s(ge)[w.accountData.service],"service-name":w.accountData.service},null,8,["logo","service-name"])]),e("div",ln,[d(s(ce),{class:"h-6 w-5 w-min-5 w-max-5 min-h-5 max-w-5 text-blue-500"}),e("div",cn,[O($(c.description)+" ",1),e("a",{href:c.link,target:"_blank",class:"text-blue-500 underline"},"here",8,rn),O(" . ")])]),e("div",dn,[e("div",un,[(o(!0),l(L,null,B(f.value,g=>(o(),l("div",{key:g.name,class:"flex flex-col gap-1"},[d(N,{modelValue:a[g.name],"onUpdate:modelValue":z=>a[g.name]=z,label:g.label,name:g.name,type:g.type,placeholder:g.placeholder},null,8,["modelValue","onUpdate:modelValue","label","name","type","placeholder"])]))),128))]),e("div",_n,[(o(!0),l(L,null,B(s(_e),g=>(o(),l("div",{key:g.name,class:"flex flex-col gap-1"},[d(N,{modelValue:a[g.name],"onUpdate:modelValue":z=>a[g.name]=z,label:g.label,name:g.name,type:g.type},null,8,["modelValue","onUpdate:modelValue","label","name","type"]),e("p",mn,$(g.description),1)]))),128))]),m.value?(o(),k(F,{key:0,class:"ml-1",message:m.value},null,8,["message"])):x("",!0)]),e("div",pn,[d(j,{label:"Back",theme:"gray",variant:"outline",disabled:b.value,onClick:I[0]||(I[0]=g=>i("update:step","email-list"))},null,8,["disabled"]),d(j,{label:"Update Account",variant:"solid",onClick:p,loading:b.value},null,8,["loading"])])])}}}),gn={class:"flex-1"},fn={key:0,class:"h-full"},vn={key:1,class:"h-full"},xn={key:2,class:"h-full"},wn=A({__name:"EmailConfig",setup(r){const t=D("email-list"),n=D(null);function i(a,c){t.value=a,n.value=c}return(a,c)=>(o(),l("div",gn,[t.value==="email-add"?(o(),l("div",fn,[d(Go,{"onUpdate:step":i})])):t.value==="email-list"?(o(),l("div",vn,[d(on,{"onUpdate:step":i})])):t.value==="email-edit"?(o(),l("div",xn,[d(hn,{"account-data":n.value,"onUpdate:step":i},null,8,["account-data"])])):x("",!0)]))}}),bn={class:"flex flex-col gap-4"},kn=e("h1",{class:"text-lg font-semibold"},"Customise your Helpdesk",-1),yn={class:"flex flex-col gap-2"},$n={class:"text-sm text-gray-600"},Cn={class:"flex gap-4 items-center"},Sn={key:2},Ln=A({__name:"Branding",setup(r){const t=G(),n=U({brandLogo:t.brandLogo,brandFavicon:""}),i=U({logoLoading:!1,faviconLoading:!1}),a=M(()=>[{title:"Brand Logo",image:n.brandLogo,doctype:"HD Settings",fieldname:"brand_logo",loading:i.logoLoading},{title:"Brand Favicon",image:n.brandFavicon,doctype:"Website Settings",fieldname:"favicon",loading:i.faviconLoading}]),c=T({url:"frappe.client.get_value",cache:!0,params:{doctype:"Website Settings",fieldname:"favicon"},onSuccess(p){n.brandFavicon=p.favicon},auto:!0}),_=T({url:"frappe.client.set_value",debounce:1e3,onSuccess(p){p.doctype==="HD Settings"?m(p.brand_logo):b(p.favicon)},onError(){R({title:"Failed to update, please try again",icon:"x",iconClasses:"text-red-600"}),i.logoLoading=!1,i.faviconLoading=!1}});function f(p,h,C){_.submit({doctype:h,name:h,fieldname:C,value:p}),h==="HD Settings"?i.logoLoading=!0:i.faviconLoading=!0}function m(p){n.brandLogo=p,i.logoLoading=!1,R({title:"Brand Logo Updated",icon:"check",iconClasses:"text-green-600"})}function b(p){n.brandFavicon=p,i.faviconLoading=!1,R({title:"Favicon Updated",text:"Please refresh the page to see the changes",icon:"check",iconClasses:"text-green-600"})}return(p,h)=>{const C=y("Button");return o(),l("div",bn,[kn,(o(!0),l(L,null,B(a.value,v=>(o(),l("div",yn,[e("p",$n,$(v.title),1),e("div",Cn,[v.image&&!s(c).loading?(o(),k(s(We),{key:0,size:"3xl",image:v.image},null,8,["image"])):x("",!0),v.image?(o(),l("div",Sn,[d(C,{label:"Remove",onClick:S=>f("",v.doctype,v.fieldname),iconLeft:"trash",loading:v.loading},null,8,["onClick","loading"])])):(o(),k(s(Xe),{key:1,fileTypes:["image/*"],onSuccess:S=>{f(S.file_url,v.doctype,v.fieldname)}},{default:E(({openFileSelector:S})=>[d(C,{onClick:u=>S(),iconLeft:"upload",label:"Upload Image",loading:v.loading},null,8,["onClick","loading"])]),_:2},1032,["onSuccess"]))])]))),256))])}}}),An={class:"flex",style:{height:"calc(100vh - 8rem)"}},En={class:"flex w-52 shrink-0 flex-col bg-gray-50 p-2"},Bn=e("h1",{class:"px-2 pt-2 text-lg font-semibold"},"Settings",-1),Dn={class:"mt-3"},Mn=["onClick"],In={class:"text-base text-gray-800"},Vn={class:"flex flex-1 flex-col overflow-scroll p-4"},Rn=A({__name:"SettingsModal",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r){let t=[{label:"Email Accounts",icon:Co,component:wn},{label:"Branding",icon:Bo,component:Ln}];const n=ye(r,"modelValue"),i=D(t[0]);return(a,c)=>(o(),k(s($e),{modelValue:n.value,"onUpdate:modelValue":c[0]||(c[0]=_=>n.value=_),options:{size:"4xl"}},{body:E(()=>[e("div",An,[e("div",En,[Bn,e("div",Dn,[(o(!0),l(L,null,B(s(t),_=>(o(),l("button",{key:_.label,class:V(["flex h-7 w-full items-center gap-2 rounded px-2 py-1",[i.value?.label==_.label?"bg-white shadow-sm":"hover:bg-gray-100"]]),onClick:f=>i.value=_},[(o(),k(q(_.icon),{class:"h-4 w-4 text-gray-700"})),e("span",In,$(_.label),1)],10,Mn))),128))])]),e("div",Vn,[i.value?(o(),k(q(i.value.component),{key:0})):x("",!0)])])]),_:1},8,["modelValue"]))}}),Tn={},Nn={fill:"none",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg"},Fn=e("path",{class:"","clip-rule":"evenodd",d:"M13.8496 4.69692L12.0062 6.54029C11.8109 6.73555 11.4944 6.73555 11.2991 6.54028L9.45572 4.69692C9.26046 4.50166 9.26046 4.18508 9.45572 3.98981L11.2991 2.14645C11.4944 1.95118 11.8109 1.95118 12.0062 2.14645L13.8496 3.98981C14.0448 4.18507 14.0448 4.50166 13.8496 4.69692ZM14.5567 3.28271C15.1425 3.86849 15.1425 4.81824 14.5567 5.40403L12.7133 7.24739C12.1275 7.83318 11.1778 7.83318 10.592 7.24739L8.74862 5.40402C8.16283 4.81824 8.16283 3.86849 8.74862 3.28271L10.592 1.43934C11.1778 0.853553 12.1275 0.853554 12.7133 1.43934L14.5567 3.28271ZM5.60691 4.34338C5.60691 5.3394 4.79948 6.14683 3.80346 6.14683C2.80743 6.14683 2 5.3394 2 4.34338C2 3.34736 2.80743 2.53992 3.80346 2.53992C4.79948 2.53992 5.60691 3.34736 5.60691 4.34338ZM6.60691 4.34338C6.60691 5.89168 5.35176 7.14683 3.80346 7.14683C2.25515 7.14683 1 5.89168 1 4.34338C1 2.79507 2.25515 1.53992 3.80346 1.53992C5.35176 1.53992 6.60691 2.79507 6.60691 4.34338ZM12.9565 10.3897H10.3495C10.0734 10.3897 9.84954 10.6136 9.84954 10.8897V13.4966C9.84954 13.7728 10.0734 13.9966 10.3495 13.9966H12.9565C13.2326 13.9966 13.4565 13.7728 13.4565 13.4966V10.8897C13.4565 10.6136 13.2326 10.3897 12.9565 10.3897ZM10.3495 9.38971C9.52112 9.38971 8.84954 10.0613 8.84954 10.8897V13.4966C8.84954 14.325 9.52111 14.9966 10.3495 14.9966H12.9565C13.7849 14.9966 14.4565 14.325 14.4565 13.4966V10.8897C14.4565 10.0613 13.7849 9.38971 12.9565 9.38971H10.3495ZM2.5 10.3897H5.10691C5.38305 10.3897 5.60691 10.6136 5.60691 10.8897V13.4966C5.60691 13.7728 5.38306 13.9966 5.10691 13.9966H2.5C2.22386 13.9966 2 13.7728 2 13.4966V10.8897C2 10.6136 2.22386 10.3897 2.5 10.3897ZM1 10.8897C1 10.0613 1.67157 9.38971 2.5 9.38971H5.10691C5.93534 9.38971 6.60691 10.0613 6.60691 10.8897V13.4966C6.60691 14.325 5.93534 14.9966 5.10691 14.9966H2.5C1.67157 14.9966 1 14.325 1 13.4966V10.8897Z",fill:"currentColor","fill-rule":"evenodd"},null,-1),jn=[Fn];function Pn(r,t){return o(),l("svg",Nn,jn)}const Un=Ce(Tn,[["render",Pn]]),On={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},Hn=e("path",{d:"m9 18 6-6-6-6"},null,-1),zn=[Hn];function qn(r,t){return o(),l("svg",On,[...zn])}const Gn={name:"lucide-chevron-right",render:qn},Zn=["onClick"],Kn={class:"flex gap-2"},Yn=e("span",{class:"whitespace-nowrap"},"Apps",-1),Wn={class:"grid grid-cols-3 justify-between mx-3 p-2 rounded-lg border border-gray-100 bg-white shadow-xl"},Xn={key:"name"},Jn=["href"],Qn=["src"],ea=["onClick"],ta={__name:"Apps",setup(r){const t=T({url:"frappe.apps.get_apps",cache:"apps",auto:!0,transform:n=>{let i=[{name:"frappe",logo:"/assets/helpdesk/desk/desk.png",title:"Desk",route:"/app"}];return n.map(a=>{a.name!=="helpdesk"&&i.push({name:a.name,logo:a.logo,title:a.title,route:a.route})}),i}});return(n,i)=>(o(),k(s(Le),{placement:"right-start",class:"flex w-full"},{target:E(({togglePopover:a})=>[e("button",{class:V(["group w-full flex h-7 items-center justify-between rounded px-2 text-base text-gray-800 hover:bg-gray-100"]),onClick:Se(c=>a(),["prevent"])},[e("div",Kn,[d(Un),Yn]),d(s(Gn),{class:"h-4 w-4 stroke-1.5"})],8,Zn)]),body:E(()=>[e("div",Wn,[(o(!0),l(L,null,B(s(t).data,a=>(o(),l("div",Xn,[e("a",{href:a.route,class:"flex flex-col gap-1.5 rounded justify-center items-center py-2 px-3 hover:bg-gray-100"},[e("img",{class:"size-8",src:a.logo},null,8,Qn),e("div",{class:"text-sm",onClick:a.onClick},$(a.title),9,ea)],8,Jn)]))),128))])]),_:1}))}},oa={class:"flex items-center gap-0.5 font-medium text-gray-600"},na=e("span",null,"K",-1),aa={class:"mb-4"},sa={key:0,class:"absolute z-20 h-1.5 w-1.5 translate-x-6 translate-y-1 rounded-full bg-gray-800",theme:"gray",variant:"solid"},ia={class:"mb-4 flex flex-col gap-1"},la=e("div",{class:"grow"},null,-1),ca=A({__name:"SideBar",setup(r){const t=De(),n=te(),i=H(),a=re(),{isExpanded:c,width:_}=Ae(Z()),f=Ee(),m=D(!1),b=M(()=>[{label:"Tickets",icon:Ue,to:Me},{label:"Agents",icon:no,to:Ie},{label:"Knowledge base",icon:Oe,to:"DeskKBHome"},{label:"Teams",icon:xo,to:Ve},{label:"Canned responses",icon:Pt,to:"CannedResponses"},{label:"Customers",icon:uo,to:Re},{label:"Contacts",icon:qt,to:Te}]),p=[{component:Be(ta)},{label:"Customer portal",icon:"users",onClick:()=>{const C=n.resolve({name:ee});window.open(C.href)}},{icon:"life-buoy",label:"Support",onClick:()=>window.open("https://t.me/frappedesk")},{icon:"book-open",label:"Docs",onClick:()=>window.open("https://docs.frappe.io/helpdesk")},{label:"Settings",icon:"settings",onClick:()=>m.value=!0,condition:()=>i.isAdmin},{label:"Log out",icon:"log-out",onClick:()=>i.logout()}];function h(){window.dispatchEvent(new KeyboardEvent("keydown",{key:"k",metaKey:!0}))}return(C,v)=>{const S=y("Badge");return o(),l("div",{class:"z-0 flex select-none flex-col border-r border-gray-200 bg-gray-50 p-2 text-base duration-300 ease-in-out",style:Q({"min-width":s(_),"max-width":s(_)})},[d(wt,{class:"mb-2 ml-0.5",options:p}),d(s(P),{label:"Search",class:"mb-1",icon:s(Pe),"on-click":()=>h(),"is-expanded":s(c)},{right:E(()=>[e("span",oa,[(o(),k(q(s(f).modifierIcon),{class:"h-3 w-3"})),na])]),_:1},8,["icon","on-click","is-expanded"]),e("span",aa,[s(a).unread?(o(),l("div",sa)):x("",!0),d(s(P),{class:"relative",label:"Notifications",icon:s(Xt),"on-click":()=>s(a).toggle(),"is-expanded":s(c)},{right:E(()=>[s(c)&&s(a).unread?(o(),k(S,{key:0,label:s(a).unread,theme:"gray",variant:"subtle"},null,8,["label"])):x("",!0)]),_:1},8,["icon","on-click","is-expanded"])]),e("div",ia,[(o(!0),l(L,null,B(b.value,u=>(o(),k(s(P),J({ref_for:!0},u,{key:u.label,"is-expanded":s(c),"is-active":u.to?.includes(s(t).name.toString())}),null,16,["is-expanded","is-active"]))),128))]),la,d(s(P),{icon:s(c)?s(Lt):s(Vt),"is-active":!1,"is-expanded":s(c),label:s(c)?"Collapse":"Expand","on-click":()=>c.value=!s(c)},null,8,["icon","is-expanded","label","on-click"]),s(i).isAdmin?(o(),k(Rn,{key:0,modelValue:m.value,"onUpdate:modelValue":v[0]||(v[0]=u=>m.value=u)},null,8,["modelValue"])):x("",!0)],4)}}}),ra={class:"flex h-screen w-screen"},$a=A({__name:"AgentRoot",setup(r){const t=te(),n=H(),i=G();return Ne(()=>{n.hasDeskAccess||t.replace({name:ee}),i.isSetupComplete||t.replace({name:Fe})}),(a,c)=>{const _=y("RouterView");return o(),l("div",ra,[d(ca),d(s(ft)),d(_,{class:"z-0 flex flex-1 flex-col overflow-auto"}),d(s(He))])}}});export{$a as default};
//# sourceMappingURL=AgentRoot-f25b8eaf.js.map
