import{d as L,v as y,I as U,az as w,N as E,o as r,i,f as l,g as a,w as d,h as e,F as T,r as D,q as C,B as I,b as P,E as q,bo as A,_ as b,a4 as z,e as G,O as H,D as V}from"./index-a86022ab.js";import{_ as F}from"./Avatar.vue_vue_type_script_setup_true_lang-f38fd5a3.js";import{_ as j}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-3ebac268.js";import{D as J}from"./Dropdown-068a4fad.js";import{u as K,_ as Q}from"./agent-487634f4.js";import{u as h}from"./error-90c51c34.js";import"./vuedraggable.umd-9334f31c.js";import{_ as W}from"./PageTitle.vue_vue_type_script_setup_true_lang-022e67c2.js";import"./iconify-6a43d462.js";import{_ as X}from"./plus-3ad50efe.js";import{I as Y}from"./more-horizontal-b738918e.js";import{_ as Z}from"./Pill-e8642e27.js";import"./label-fe9568ec.js";import"./x-948a4c6e.js";const ee={class:"flex flex-col"},te={class:"flex items-center gap-2"},se={class:"my-6"},ae={class:"container"},oe={class:"space-y-4"},le=l("div",{class:"text-lg font-medium"},"Members",-1),ne={key:0,class:"flex flex-wrap gap-2"},re={key:1,class:"text-base text-gray-900"},ie={class:"space-y-2"},de={class:"space-y-2"},me={key:0},ue={class:"text-base text-gray-600"},ce={class:"flex items-center gap-2"},pe={class:"text-base"},Ce=L({__name:"TeamSingle",props:{teamId:{type:String,required:!0}},setup(u){const v=u,g=P(),x=K(),c=y(!1),p=y(!1),_=y(!1),o=U({doctype:"HD Team",name:v.teamId,auto:!0,setValue:{onError:h({title:"Error updating team"})},delete:{onSuccess(){g.replace({name:w})},onError:h({title:"Error deleting team"})}}),m=E({get(){return o.doc?.name},set(n){o.doc.name=n}}),k=E({get(){return!!o.doc?.ignore_restrictions},set(n){o.doc&&o.setValue.submit({ignore_restrictions:n})}}),N=[{label:"Rename",icon:"edit-3",onClick:()=>c.value=!c.value},{label:"Delete",icon:"trash-2",onClick:()=>p.value=!p.value}],$={title:"Rename team"},M={title:"Add member"},R={title:"Delete team",message:`Are you sure you want to delete ${v.teamId}? This action cannot be reversed!`,actions:[{label:"Confirm",theme:"red",variant:"solid",onClick:()=>o.delete.submit()}]};function S(){q({url:"frappe.client.rename_doc",makeParams(){return{doctype:"HD Team",old_name:v.teamId,new_name:m.value}},validate(t){if(!t.new_name)return"New title is required";if(t.new_name===t.old_name)return"New and old title cannot be same"},onSuccess(){g.replace({name:A,params:{teamId:m.value}})},onError:h({title:"Error renaming team"})}).submit()}function O(n){const t=o.doc.users.concat([{user:n}]);o.setValue.submit({users:t})}function B(n){const t=o.doc.users.filter(s=>s.user!==n);o.setValue.submit({users:t})}return(n,t)=>(r(),i("span",null,[l("div",ee,[a(e(W),{class:"border-b"},{title:d(()=>[a(e(j),{items:[{label:"Teams",route:{name:e(w)}},{label:u.teamId,route:{name:e(A)}}]},null,8,["items"])]),right:d(()=>[l("div",te,[a(e(b),{label:"Add member",theme:"gray",variant:"solid",onClick:t[0]||(t[0]=s=>_.value=!_.value)},{prefix:d(()=>[a(e(X),{class:"h-4 w-4"})]),_:1}),a(e(J),{options:N},{default:d(()=>[a(e(b),{variant:"ghost"},{icon:d(()=>[a(e(Y),{class:"h-4 w-4"})]),_:1})]),_:1})])]),_:1}),l("div",se,[l("div",ae,[l("div",oe,[le,e(z.isEmpty)(e(o).doc?.users)?(r(),i("div",re," No members found in team: "+C(u.teamId),1)):(r(),i("div",ne,[(r(!0),i(T,null,D(e(o).doc?.users,s=>(r(),G(Z,{key:s.user,label:s.user,disabled:e(o).loading,onClick:t[1]||(t[1]=f=>B(f))},null,8,["label","disabled"]))),128))])),a(e(Q),{modelValue:k.value,"onUpdate:modelValue":t[2]||(t[2]=s=>k.value=s),size:"md",label:"Bypass restrictions",description:"Members of this team will be able to bypass any team-wise restriction",class:"rounded border p-4"},null,8,["modelValue"])])])])]),a(e(V),{modelValue:c.value,"onUpdate:modelValue":t[4]||(t[4]=s=>c.value=s),options:$},{"body-content":d(()=>[l("div",ie,[a(e(H),{modelValue:m.value,"onUpdate:modelValue":t[3]||(t[3]=s=>m.value=s),label:"Title",placeholder:"Product Experts"},null,8,["modelValue"]),a(e(b),{label:"Confirm",theme:"gray",variant:"solid",class:"w-full",disabled:m.value===u.teamId,onClick:S},null,8,["disabled"])])]),_:1},8,["modelValue"]),a(e(V),{modelValue:p.value,"onUpdate:modelValue":t[5]||(t[5]=s=>p.value=s),options:R},null,8,["modelValue"]),a(e(V),{modelValue:_.value,"onUpdate:modelValue":t[7]||(t[7]=s=>_.value=s),options:M},{"body-content":d(()=>[l("div",de,[e(x).agents.data.length===0?(r(),i("div",me,[l("p",ue,[I(" No agents found, please add "),l("span",{class:"cursor-pointer underline",onClick:t[6]||(t[6]=s=>e(g).push("/agents"))},"agents"),I(" in the system. ")])])):(r(!0),i(T,{key:1},D(e(x).agents.data,s=>(r(),i("div",{key:s.name,class:"flex items-center justify-between"},[l("div",ce,[a(e(F),{label:s.agent_name,image:s.user_image},null,8,["label","image"]),l("div",pe,C(s.agent_name),1)]),a(e(b),{disabled:!!e(o).doc?.users.find(f=>f.user===s.user),label:"Add",theme:"gray",variant:"outline",onClick:f=>O(s.user)},null,8,["disabled","onClick"])]))),128))])]),_:1},8,["modelValue"])]))}});export{Ce as default};
//# sourceMappingURL=TeamSingle-d13abfea.js.map
