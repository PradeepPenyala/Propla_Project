{"version":3,"file":"KnowledgeBasePublic-1a569133.js","sources":["../../../../desk/src/pages/knowledge-base/KnowledgeBasePublicSearch.vue","../../../../desk/src/pages/KnowledgeBasePublic.vue"],"sourcesContent":["<template>\n  <Dialog\n    :options=\"{ size: 'xl', position: 'top' }\"\n    :model-value=\"modelValue\"\n    @update:model-value=\"emit('update:modelValue', !modelValue)\"\n    @after-leave=\"articles.data = null\"\n  >\n    <template #body>\n      <div>\n        <Combobox nullable @update:model-value=\"onSelection\">\n          <div class=\"relative\">\n            <div class=\"pl-4.5 absolute inset-y-0 left-0 flex items-center\">\n              <Icon icon=\"lucide:search\" class=\"h-4 w-4\" />\n            </div>\n            <ComboboxInput\n              placeholder=\"Search\"\n              class=\"pl-11.5 pr-4.5 w-full border-none bg-transparent py-3 text-base text-gray-800 placeholder:text-gray-500 focus:ring-0\"\n              autocomplete=\"off\"\n              @input=\"onInput\"\n            />\n          </div>\n          <ComboboxOptions\n            class=\"max-h-96 overflow-auto border-t border-gray-100 text-base\"\n            :class=\"{\n              'py-2.5': !!articles.data,\n            }\"\n            static\n            hold\n          >\n            <ComboboxOption\n              v-for=\"article in articles.data\"\n              :key=\"article.name\"\n              v-slot=\"{ active }\"\n              :value=\"article\"\n              class=\"px-2.5\"\n            >\n              <div\n                class=\"flex w-full min-w-0 items-center gap-1 rounded p-2 text-base font-medium text-gray-800\"\n                :class=\"{ 'bg-gray-200': active }\"\n              >\n                <span\n                  class=\"overflow-hidden text-ellipsis whitespace-nowrap text-gray-700\"\n                >\n                  {{ article.category_name }}\n                </span>\n                <span class=\"text-gray-700\"> / </span>\n                <span class=\"overflow-hidden text-ellipsis whitespace-nowrap\">\n                  {{ article.title }}\n                </span>\n              </div>\n            </ComboboxOption>\n          </ComboboxOptions>\n        </Combobox>\n      </div>\n    </template>\n  </Dialog>\n</template>\n\n<script setup lang=\"ts\">\nimport { toRef } from \"vue\";\nimport { createListResource, Dialog } from \"frappe-ui\";\nimport {\n  Combobox,\n  ComboboxInput,\n  ComboboxOptions,\n  ComboboxOption,\n} from \"@headlessui/vue\";\nimport { Icon } from \"@iconify/vue\";\nimport { useRouter } from \"vue-router\";\nimport { KB_PUBLIC_ARTICLE } from \"@/router\";\n\ninterface P {\n  modelValue: boolean;\n}\n\ninterface E {\n  (event: \"update:modelValue\", value: boolean): void;\n}\n\nconst props = defineProps<P>();\nconst emit = defineEmits<E>();\nconst router = useRouter();\nconst modelValue = toRef(props, \"modelValue\");\nconst articles = createListResource({\n  doctype: \"HD Article\",\n  fields: [\"name\", \"title\", \"category.category_name\"],\n  filters: {\n    status: \"Published\",\n  },\n  pageLength: 99999,\n  debounce: 500,\n  auto: false,\n  transform: (data) => {\n    for (const d of data) {\n      d.route = {\n        name: KB_PUBLIC_ARTICLE,\n        params: {\n          articleId: d.name,\n        },\n      };\n    }\n    return data;\n  },\n});\n\nfunction onInput(e) {\n  articles.update({\n    filters: {\n      title: [\"like\", `%${e.target.value}%`],\n    },\n  });\n  articles.reload();\n}\n\nfunction onSelection(val) {\n  if (val) {\n    emit(\"update:modelValue\", !modelValue.value);\n    router.push(val.route);\n  }\n}\n</script>\n","<template>\n  <span>\n    <header class=\"bg-gray-100\">\n      <div class=\"container m-auto\">\n        <div class=\"flex justify-between py-2\">\n          <div class=\"flex items-center gap-2\">\n            <RouterLink :to=\"{ name: CUSTOMER_PORTAL_LANDING }\">\n              <BrandLogo class=\"flex\" />\n            </RouterLink>\n            <span class=\"text-gray-600\">/</span>\n            <span class=\"font-medium text-gray-900\">Knowledge Base</span>\n          </div>\n          <Button\n            label=\"Search\"\n            theme=\"gray\"\n            variant=\"outline\"\n            @click=\"showSearch = !showSearch\"\n          >\n            <template #prefix>\n              <Icon icon=\"lucide:search\" />\n            </template>\n            <template #suffix>\n              <span class=\"flex items-center gap-1\">\n                <Icon icon=\"lucide:command\" class=\"h-3 w-3\" />\n                K\n              </span>\n            </template>\n          </Button>\n        </div>\n      </div>\n    </header>\n    <RouterView :key=\"$route.fullPath\" class=\"m-auto\" />\n    <KnowledgeBasePublicSearch v-model=\"showSearch\" />\n  </span>\n</template>\n\n<script setup lang=\"ts\">\nimport { onMounted, onUnmounted, ref } from \"vue\";\nimport { Button } from \"frappe-ui\";\nimport { Icon } from \"@iconify/vue\";\nimport { CUSTOMER_PORTAL_LANDING } from \"@/router\";\nimport { useKeymapStore } from \"@/stores/keymap\";\nimport BrandLogo from \"@/components/BrandLogo.vue\";\nimport KnowledgeBasePublicSearch from \"./knowledge-base/KnowledgeBasePublicSearch.vue\";\n\nconst keymapStore = useKeymapStore();\nconst showSearch = ref(false);\nconst mapping = [\"meta\", \"k\"];\nonMounted(() =>\n  keymapStore.add(mapping, () => (showSearch.value = !showSearch.value))\n);\nonUnmounted(() => keymapStore.remove(mapping));\n</script>\n"],"names":["props","__props","emit","__emit","router","useRouter","modelValue","toRef","articles","createListResource","data","d","KB_PUBLIC_ARTICLE","onInput","e","onSelection","val","keymapStore","useKeymapStore","showSearch","ref","mapping","onMounted","onUnmounted"],"mappings":"4yBA+EA,MAAAA,EAAAC,EACAC,EAAAC,EACAC,EAAAC,IACAC,EAAAC,EAAAP,EAAA,YAAA,EACAQ,EAAAC,EAAA,CAAoC,QAAA,aACzB,OAAA,CAAA,OAAA,QAAA,wBAAA,EACyC,QAAA,CACzC,OAAA,WACC,EACV,WAAA,MACY,SAAA,IACF,KAAA,GACJ,UAAAC,GAAA,CAEJ,UAAAC,KAAAD,EACEC,EAAA,MAAA,CAAU,KAAAC,EACF,OAAA,CACE,UAAAD,EAAA,IACO,CACf,EAGJ,OAAAD,CAAO,CACT,CAAA,EAGF,SAAAG,EAAAC,EAAA,CACEN,EAAA,OAAA,CAAgB,QAAA,CACL,MAAA,CAAA,OAAA,IAAAM,EAAA,OAAA,KAAA,GAAA,CAC8B,CACvC,CAAA,EAEFN,EAAA,OAAA,CAAgB,CAGlB,SAAAO,EAAAC,EAAA,CACEA,IACEd,EAAA,oBAAA,CAAAI,EAAA,KAAA,EACAF,EAAA,KAAAY,EAAA,KAAA,EACF,g3CCzEF,MAAAC,EAAAC,IACAC,EAAAC,EAAA,EAAA,EACAC,EAAA,CAAA,OAAA,GAAA,EACA,OAAAC,EAAA,IAAAL,EAAA,IAAAI,EAAA,IAAAF,EAAA,MAAA,CAAAA,EAAA,KAAA,CACuE,EAEvEI,EAAA,IAAAN,EAAA,OAAAI,CAAA,CAAA"}