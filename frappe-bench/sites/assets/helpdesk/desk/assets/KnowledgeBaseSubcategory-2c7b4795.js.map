{"version":3,"file":"KnowledgeBaseSubcategory-2c7b4795.js","sources":["../../../../desk/src/pages/knowledge-base/KnowledgeBaseSubcategory.vue"],"sourcesContent":["<template>\n  <div class=\"flex grow flex-col\">\n    <KnowledgeBaseCategoryHeader\n      :title=\"subCategory.doc?.category_name\"\n      :description=\"subCategory.doc?.description\"\n    >\n      <template #right>\n        <div class=\"space-x-2\">\n          <Button\n            label=\"Edit\"\n            theme=\"gray\"\n            variant=\"outline\"\n            @click=\"showEdit = !showEdit\"\n          >\n            <template #prefix>\n              <IconEdit class=\"h-4 w-4\" />\n            </template>\n          </Button>\n          <Button\n            label=\"Add new\"\n            theme=\"gray\"\n            variant=\"solid\"\n            @click=\"toNewArticle\"\n          >\n            <template #prefix>\n              <IconPlus class=\"h-4 w-4\" />\n            </template>\n          </Button>\n        </div>\n      </template>\n    </KnowledgeBaseCategoryHeader>\n    <ListView :columns=\"columns\" :resource=\"articles\" doctype=\"HD Article\">\n      <template #title=\"{ data }\">\n        <div class=\"flex items-center gap-2\">\n          <div><IconFile class=\"h-4 w-4\" /></div>\n          <div class=\"truncate\">\n            {{ data.title }}\n          </div>\n        </div>\n      </template>\n      <template #status=\"{ data }\">\n        <Badge\n          :theme=\"data.status === 'Published' ? 'green' : 'orange'\"\n          variant=\"subtle\"\n        >\n          {{ data.status }}\n        </Badge>\n      </template>\n      <template #emptyMessage>\n        <EmptyMessage message=\"This sub category is empty\" />\n      </template>\n    </ListView>\n    <Dialog v-model=\"showEdit\" :options=\"{ title: 'Edit' }\">\n      <template #body-content>\n        <form @submit.prevent=\"saveSubCategory\">\n          <div class=\"space-y-4\">\n            <FormControl\n              v-model=\"newSubCategoryName\"\n              :placeholder=\"subCategory.doc.category_name\"\n              label=\"Name\"\n              type=\"text\"\n            />\n            <FormControl\n              v-model=\"newSubCategoryDescription\"\n              :placeholder=\"subCategory.doc.description\"\n              label=\"Description\"\n              type=\"textarea\"\n            />\n            <Button\n              :disabled=\"!newSubCategoryName && !newSubCategoryDescription\"\n              class=\"w-full\"\n              label=\"Save\"\n              theme=\"gray\"\n              variant=\"solid\"\n            />\n          </div>\n        </form>\n      </template>\n    </Dialog>\n  </div>\n</template>\n<script setup lang=\"ts\">\nimport { ref } from \"vue\";\nimport { useRoute, useRouter } from \"vue-router\";\nimport {\n  createDocumentResource,\n  debounce,\n  Badge,\n  Button,\n  Dialog,\n  FormControl,\n} from \"frappe-ui\";\nimport { AGENT_PORTAL_KNOWLEDGE_BASE_ARTICLE } from \"@/router\";\nimport { createListManager } from \"@/composables/listManager\";\nimport { useError } from \"@/composables/error\";\nimport { ListView } from \"@/components\";\nimport KnowledgeBaseCategoryHeader from \"./KnowledgeBaseCategoryHeader.vue\";\nimport EmptyMessage from \"@/components/EmptyMessage.vue\";\nimport IconEdit from \"~icons/lucide/edit-3\";\nimport IconFile from \"~icons/lucide/file-text\";\nimport IconPlus from \"~icons/lucide/plus\";\n\nconst props = defineProps({\n  subCategoryId: {\n    type: String,\n    required: true,\n  },\n});\n\nconst router = useRouter();\nconst route = useRoute();\nconst newSubCategoryName = ref(\"\");\nconst newSubCategoryDescription = ref(\"\");\nconst showEdit = ref(false);\n\nconst subCategory = createDocumentResource({\n  doctype: \"HD Article Category\",\n  name: props.subCategoryId,\n  auto: true,\n  setValue: {\n    onError: useError({ title: \"Error creating sub category\" }),\n  },\n});\n\nconst saveSubCategory = debounce(\n  () =>\n    subCategory.setValue.submit({\n      category_name: newSubCategoryName.value || subCategory.doc.category_name,\n      description:\n        newSubCategoryDescription.value || subCategory.doc.description,\n    }),\n  500\n);\n\nconst articles = createListManager({\n  doctype: \"HD Article\",\n  filters: {\n    category: props.subCategoryId,\n  },\n  auto: true,\n  transform: (data) => {\n    for (const d of data) {\n      d.onClick = {\n        name: AGENT_PORTAL_KNOWLEDGE_BASE_ARTICLE,\n        params: {\n          articleId: d.name,\n        },\n        query: {\n          category: route.params.categoryId,\n          subCategory: route.params.subCategoryId,\n        },\n      };\n    }\n    return data;\n  },\n});\n\nconst columns = [\n  {\n    label: \"Title\",\n    key: \"title\",\n    width: \"w-96\",\n  },\n  {\n    label: \"Status\",\n    key: \"status\",\n    width: \"w-40\",\n  },\n];\n\nfunction toNewArticle() {\n  router.push({\n    name: AGENT_PORTAL_KNOWLEDGE_BASE_ARTICLE,\n    params: {\n      articleId: \"new\",\n    },\n    query: {\n      category: route.params.categoryId,\n      subCategory: route.params.subCategoryId,\n    },\n  });\n}\n</script>\n"],"names":["props","__props","router","useRouter","route","useRoute","newSubCategoryName","ref","newSubCategoryDescription","showEdit","subCategory","createDocumentResource","useError","saveSubCategory","debounce","articles","createListManager","data","d","AGENT_PORTAL_KNOWLEDGE_BASE_ARTICLE","columns","toNewArticle"],"mappings":"4+BAsGA,MAAAA,EAAAC,EAOAC,EAAAC,IACAC,EAAAC,IACAC,EAAAC,EAAA,EAAA,EACAC,EAAAD,EAAA,EAAA,EACAE,EAAAF,EAAA,EAAA,EAEAG,EAAAC,EAAA,CAA2C,QAAA,sBAChC,KAAAX,EAAA,cACG,KAAA,GACN,SAAA,CACI,QAAAY,EAAA,CAAA,MAAA,6BAAA,CAAA,CACkD,CAC5D,CAAA,EAGFC,EAAAC,EAAwB,IAAAJ,EAAA,SAAA,OAAA,CAEQ,cAAAJ,EAAA,OAAAI,EAAA,IAAA,cACiC,YAAAF,EAAA,OAAAE,EAAA,IAAA,WAEN,CAAA,EACtD,GACH,EAGFK,EAAAC,EAAA,CAAmC,QAAA,aACxB,QAAA,CACA,SAAAhB,EAAA,aACS,EAClB,KAAA,GACM,UAAAiB,GAAA,CAEJ,UAAAC,KAAAD,EACEC,EAAA,QAAA,CAAY,KAAAC,EACJ,OAAA,CACE,UAAAD,EAAA,IACO,EACf,MAAA,CACO,SAAAd,EAAA,OAAA,WACkB,YAAAA,EAAA,OAAA,aACG,CAC5B,EAGJ,OAAAa,CAAO,CACT,CAAA,EAGFG,EAAA,CAAgB,CACd,MAAA,QACS,IAAA,QACF,MAAA,MACE,EACT,CACA,MAAA,SACS,IAAA,SACF,MAAA,MACE,CACT,EAGF,SAAAC,GAAA,CACEnB,EAAA,KAAA,CAAY,KAAAiB,EACJ,OAAA,CACE,UAAA,KACK,EACb,MAAA,CACO,SAAAf,EAAA,OAAA,WACkB,YAAAA,EAAA,OAAA,aACG,CAC5B,CAAA,CACD"}