import{d as b,bb as I,at as M,a5 as H,E as z,W as C,z as V,o as v,i as x,g as l,w as _,f as r,h as a,ai as $,al as h,D as w,N as k,I as R,e as D,q as B,S as N,v as y,a6 as q}from"./index-a86022ab.js";import{_ as S}from"./Avatar.vue_vue_type_script_setup_true_lang-f38fd5a3.js";import{c as T}from"./listManager-63aba0ed.js";import{_ as A}from"./PageTitle.vue_vue_type_script_setup_true_lang-022e67c2.js";import"./vuedraggable.umd-9334f31c.js";import{_ as F}from"./LV.vue_vue_type_script_setup_true_lang-23701244.js";import"./iconify-6a43d462.js";import{_ as L}from"./plus-3ad50efe.js";import{F as P}from"./FileUploader-c45cb8d3.js";import{u as O}from"./error-90c51c34.js";import"./EmptyMessage.vue_vue_type_script_setup_true_lang-123dde9f.js";import"./TabButtons-ea997705.js";import"./label-fe9568ec.js";const W={class:"space-y-4"},j={class:"space-y-1"},G={class:"space-y-1"},J={class:"float-right flex space-x-2"},K=b({__name:"NewCustomerDialog",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:I(["customerCreated"],["update:modelValue"]),setup(g,{emit:i}){const u=i,c=M(g,"modelValue"),o=H({customer:"",domain:""}),s=z({url:"frappe.client.insert",method:"POST",data:{doc:{doctype:"HD Customer",customer_name:o.customer,domain:o.domain}},onSuccess:()=>{o.customer="",o.domain="",C({title:"Customer Created Successfully ",icon:"check",iconClasses:"text-green-600"}),u("customerCreated")},onError:d=>{C({title:d.messages[0],icon:"x",iconClasses:"text-red-600"})}});function f(){if(!o.customer){C({title:"Customer Name is required",icon:"x",iconClasses:"text-red-600"});return}s.submit({doc:{doctype:"HD Customer",customer_name:o.customer,domain:o.domain}})}return(d,t)=>{const e=V("Button");return v(),x("div",null,[l(a(w),{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=n=>c.value=n),options:{title:"Add New Customer",size:"sm"}},{"body-content":_(()=>[r("div",W,[r("div",j,[l(a(h),{modelValue:o.customer,"onUpdate:modelValue":t[0]||(t[0]=n=>o.customer=n),label:"Customer Name",type:"text",placeholder:"Tesla Inc."},null,8,["modelValue"])]),r("div",G,[l(a(h),{modelValue:o.domain,"onUpdate:modelValue":t[1]||(t[1]=n=>o.domain=n),label:"Domain",type:"text",placeholder:"eg: tesla.com, mycompany.com"},null,8,["modelValue"])]),r("div",J,[l(e,{label:"Add",theme:"gray",variant:"solid",onClick:$(f,["prevent"])})])])]),_:1},8,["modelValue"])])}}}),Q={class:"flex flex-col items-center gap-4 p-6"},X={class:"text-xl font-medium text-gray-900"},Y={class:"flex gap-2"},Z=b({__name:"CustomerDialog",props:{name:{type:String,required:!0}},emits:["customer-updated"],setup(g,{emit:i}){const u=g,c=i,o=k({get(){return s.doc?.domain},set(e){s.doc.domain=e}}),s=R({doctype:"HD Customer",name:u.name,auto:!0,setValue:{onSuccess(){C({title:"Customer updated",icon:"check",iconClasses:"text-green-500"})},onError:O({title:"Error updating customer"})}}),f=k(()=>({title:s.doc?.name,actions:[{label:"Save",theme:"gray",variant:"solid",onClick:()=>d()}]}));async function d(){await s.setValue.submit({domain:o.value}),c("customer-updated")}function t(e){s.setValue.submit({image:e?.file_url||null}),c("customer-updated")}return(e,n)=>{const m=V("Button"),U=V("Input");return v(),D(a(w),{options:f.value},{"body-main":_(()=>[r("div",Q,[r("div",X,B(a(s).doc?.name),1),l(a(S),{size:"lg",label:a(s).doc?.name,image:a(s).doc?.image,class:"cursor-pointer hover:opacity-80"},null,8,["label","image"]),r("div",Y,[l(a(P),{onSuccess:n[0]||(n[0]=p=>t(p))},{default:_(({uploading:p,openFileSelector:E})=>[l(m,{label:a(s).doc?.image?"Change photo":"Upload photo",loading:p,onClick:E},null,8,["label","loading","onClick"])]),_:1}),a(s).doc?.image?(v(),D(m,{key:0,label:"Remove photo",onClick:n[1]||(n[1]=p=>t(null))})):N("",!0)]),r("form",{class:"w-full",onSubmit:$(d,["prevent"])},[l(U,{modelValue:o.value,"onUpdate:modelValue":n[2]||(n[2]=p=>o.value=p),label:"Domain",placeholder:"example.com"},null,8,["modelValue"])],32)])]),_:1},8,["options"])}}}),ee={class:"flex flex-col"},oe={class:"flex items-center gap-2"},te={class:"line-clamp-1"},se={key:0},ge=b({__name:"CustomerList",setup(g){const i=y(!1),u=y(!1),c=y(null),o=[{label:"Name",key:"name",width:"w-80"},{label:"Domain",key:"domain",width:"w-80"}],s=T({doctype:"HD Customer",fields:["name","image","domain"],auto:!0,transform:t=>{for(const e of t)e.onClick=()=>f(e.name);return t}});q(()=>({title:"Customers"}));function f(t){c.value=t,u.value=!0}function d(t=!1){t?u.value=!1:i.value=!1,s.reload()}return(t,e)=>{const n=V("Button");return v(),x("div",ee,[l(A,{title:"Customers"},{right:_(()=>[l(n,{label:"New customer",theme:"gray",variant:"solid",onClick:e[0]||(e[0]=m=>i.value=!i.value)},{prefix:_(()=>[l(a(L),{class:"h-4 w-4"})]),_:1})]),_:1}),l(a(F),{columns:o,resource:a(s),class:"mt-2.5",doctype:"HD Customer"},{name:_(({data:m})=>[r("div",oe,[l(a(S),{label:m.name,image:m.image,size:"sm"},null,8,["label","image"]),r("div",te,B(m.name),1)])]),_:1},8,["resource"]),l(K,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=m=>i.value=m),onCustomerCreated:d},null,8,["modelValue"]),u.value?(v(),x("span",se,[l(Z,{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=m=>u.value=m),name:c.value,onCustomerUpdated:e[3]||(e[3]=m=>d(!0))},null,8,["modelValue","name"])])):N("",!0)])}}});export{ge as default};
//# sourceMappingURL=CustomerList-35465849.js.map
