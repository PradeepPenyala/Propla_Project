{"version":3,"file":"TeamList-30fc909c.js","sources":["../../../../desk/src/pages/desk/team/TeamList.vue"],"sourcesContent":["<template>\n  <div class=\"flex flex-col\">\n    <PageTitle title=\"Teams\">\n      <template #right>\n        <Button\n          label=\"New team\"\n          theme=\"gray\"\n          variant=\"solid\"\n          @click=\"showNewDialog = !showNewDialog\"\n        >\n          <template #prefix>\n            <IconPlus class=\"h-4 w-4\" />\n          </template>\n        </Button>\n      </template>\n    </PageTitle>\n    <ListView\n      :columns=\"columns\"\n      :resource=\"teams\"\n      class=\"mt-2.5\"\n      doctype=\"HD Team\"\n    />\n    <Dialog\n      v-model=\"showNewDialog\"\n      :options=\"{\n        title: 'New team',\n      }\"\n    >\n      <template #body-content>\n        <form class=\"space-y-2\" @submit.prevent=\"newTeam.submit\">\n          <FormControl\n            v-model=\"newTeamTitle\"\n            label=\"Title\"\n            placeholder=\"Product experts\"\n            type=\"text\"\n          />\n          <Button\n            :disabled=\"isEmpty(newTeamTitle)\"\n            class=\"w-full\"\n            label=\"Create\"\n            theme=\"gray\"\n            variant=\"solid\"\n          />\n        </form>\n      </template>\n    </Dialog>\n  </div>\n</template>\n<script setup lang=\"ts\">\nimport { ref } from \"vue\";\nimport { useRouter } from \"vue-router\";\nimport { createResource, usePageMeta, Dialog, FormControl } from \"frappe-ui\";\nimport { isEmpty } from \"lodash\";\nimport { AGENT_PORTAL_TEAM_SINGLE } from \"@/router\";\nimport { createListManager } from \"@/composables/listManager\";\nimport { useError } from \"@/composables/error\";\nimport PageTitle from \"@/components/PageTitle.vue\";\nimport { ListView } from \"@/components\";\nimport IconPlus from \"~icons/lucide/plus\";\n\nconst router = useRouter();\nconst showNewDialog = ref(false);\nconst newTeamTitle = ref(null);\nconst emptyMessage = \"No Teams Found\";\nconst columns = [\n  {\n    label: \"Name\",\n    key: \"name\",\n    width: \"w-80\",\n  },\n  {\n    label: \"Assignment rule\",\n    key: \"assignment_rule\",\n    width: \"w-80\",\n  },\n];\n\nconst teams = createListManager({\n  doctype: \"HD Team\",\n  fields: [\"name\", \"assignment_rule\"],\n  auto: true,\n  transform: (data) => {\n    for (const d of data) {\n      d.onClick = {\n        name: AGENT_PORTAL_TEAM_SINGLE,\n        params: {\n          teamId: d.name,\n        },\n      };\n    }\n    return data;\n  },\n});\n\nconst newTeam = createResource({\n  url: \"frappe.client.insert\",\n  makeParams() {\n    return {\n      doc: {\n        doctype: \"HD Team\",\n        team_name: newTeamTitle.value,\n      },\n    };\n  },\n  validate(params) {\n    if (isEmpty(params.doc.team_name)) return \"Title is required\";\n  },\n  auto: false,\n  onSuccess() {\n    router.replace({\n      name: AGENT_PORTAL_TEAM_SINGLE,\n      params: {\n        teamId: newTeamTitle.value,\n      },\n    });\n  },\n  onError: useError({ title: \"Error creating team\" }),\n});\n\nusePageMeta(() => {\n  return {\n    title: \"Teams\",\n  };\n});\n</script>\n"],"names":["router","useRouter","showNewDialog","ref","newTeamTitle","columns","teams","createListManager","data","d","AGENT_PORTAL_TEAM_SINGLE","newTeam","createResource","params","isEmpty","useError","usePageMeta"],"mappings":"2rBA4DA,MAAAA,EAAAC,IACAC,EAAAC,EAAA,EAAA,EACAC,EAAAD,EAAA,IAAA,EAEAE,EAAA,CAAgB,CACd,MAAA,OACS,IAAA,OACF,MAAA,MACE,EACT,CACA,MAAA,kBACS,IAAA,kBACF,MAAA,MACE,CACT,EAGFC,EAAAC,EAAA,CAAgC,QAAA,UACrB,OAAA,CAAA,OAAA,iBAAA,EACyB,KAAA,GAC5B,UAAAC,GAAA,CAEJ,UAAAC,KAAAD,EACEC,EAAA,QAAA,CAAY,KAAAC,EACJ,OAAA,CACE,OAAAD,EAAA,IACI,CACZ,EAGJ,OAAAD,CAAO,CACT,CAAA,EAGFG,EAAAC,EAAA,CAA+B,IAAA,uBACxB,YAAA,CAEH,MAAA,CAAO,IAAA,CACA,QAAA,UACM,UAAAR,EAAA,KACe,CAC1B,CACF,EACF,SAAAS,EAAA,CAEE,GAAAC,UAAAD,EAAA,IAAA,SAAA,EAAmC,MAAA,mBAAO,EAC5C,KAAA,GACM,WAAA,CAEJb,EAAA,QAAA,CAAe,KAAAU,EACP,OAAA,CACE,OAAAN,EAAA,KACe,CACvB,CAAA,CACD,EACH,QAAAW,EAAA,CAAA,MAAA,qBAAA,CAAA,CACkD,CAAA,EAGpD,OAAAC,EAAA,KACE,CAAO,MAAA,OACE,EACT"}