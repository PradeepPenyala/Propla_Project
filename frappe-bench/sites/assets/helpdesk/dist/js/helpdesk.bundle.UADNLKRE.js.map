{
  "version": 3,
  "sources": ["../../../../../apps/helpdesk/helpdesk/public/js/utils.js"],
  "sourcesContent": ["window.FileAttachmentHandler = class FileAttachmentHandler {\n  constructor() {\n    this.add_attachment_handler();\n    this.set_listeners();\n  }\n\n  add_attachment_handler() {\n    var me = this;\n    $(\".add-attachment-helpdesk\").click(function () {\n      me.new_attachment();\n    });\n  }\n\n  new_attachment() {\n    new frappe.ui.FileUploader({\n      folder: \"Home/Attachments\",\n      on_success: (file_doc) => {\n        if (!this.attachments) this.attachments = [];\n        if (!this.save_paths) this.save_paths = {};\n        this.attachments.push(file_doc);\n        $(\".helpdesk-attachment\").empty().append(this.build_attachment_table());\n        // $(\".attachment-controls\").find(\".number\").text(this.attachments.length);\n      },\n    });\n  }\n\n  build_attachment_table() {\n    var wrapper = $('<div class=\"helpdesk-attachment\"></div>');\n    wrapper.empty();\n\n    var table = $(this.get_attachment_table_header_html()).appendTo(wrapper);\n    if (!this.attachments || !this.attachments.length)\n      return \"No attachments uploaded\";\n\n    this.attachments.forEach((f) => {\n      const row = $(\"<tr></tr>\").appendTo(table.find(\"tbody\"));\n      $(`<td>${f.file_name}</td>`).appendTo(row);\n      $(`<td>\n\t\t\t<a class=\"btn btn-default btn-xs btn-primary-light text-nowrap copy-link\" data-link=\"![](${f.file_url})\" data-name = \"${f.file_name}\" >\n\t\t\t\tCopy Link\n\t\t\t</a>\n\t\t\t</td>`).appendTo(row);\n      $(`<td>\n\t\t\t<a class=\"btn btn-default btn-xs  center delete-button\"  data-name = \"${f.file_name}\" >\n\t\t\t<svg class=\"icon icon-sm\"><use xlink:href=\"#icon-delete\"></use></svg>\n\t\t\t</a>\n\t\t\t</td>`).appendTo(row);\n    });\n    return wrapper;\n  }\n\n  get_attachment_table_header_html() {\n    return `<table class=\"table  attachment-table\" \">\n\t\t\t<tbody></tbody>\n\t\t</table>`;\n  }\n\n  handle_attachment_upload_callback(method) {\n    if (this.attachments) {\n    }\n  }\n\n  set_listeners() {\n    var me = this;\n\n    $(`body`).on(\"click\", `.copy-link`, function () {\n      frappe.utils.copy_to_clipboard($(this).attr(\"data-link\"));\n    });\n\n    $(`body`).on(\"click\", `.delete-button`, function () {\n      frappe.confirm(\n        `Are you sure you want to delete the file \"${$(this).attr(\n          \"data-name\"\n        )}\"`,\n        () => {\n          me.attachments.forEach((f, index, object) => {\n            if (f.file_name == $(this).attr(\"data-name\")) {\n              object.splice(index, 1);\n            }\n          });\n          $(\".helpdesk-attachment\").empty().append(me.build_attachment_table());\n        }\n      );\n    });\n  }\n};\n"],
  "mappings": ";;AAAA,SAAO,wBAAwB,MAAM,sBAAsB;AAAA,IACzD,cAAc;AACZ,WAAK,uBAAuB;AAC5B,WAAK,cAAc;AAAA,IACrB;AAAA,IAEA,yBAAyB;AACvB,UAAI,KAAK;AACT,QAAE,0BAA0B,EAAE,MAAM,WAAY;AAC9C,WAAG,eAAe;AAAA,MACpB,CAAC;AAAA,IACH;AAAA,IAEA,iBAAiB;AACf,UAAI,OAAO,GAAG,aAAa;AAAA,QACzB,QAAQ;AAAA,QACR,YAAY,CAAC,aAAa;AACxB,cAAI,CAAC,KAAK;AAAa,iBAAK,cAAc,CAAC;AAC3C,cAAI,CAAC,KAAK;AAAY,iBAAK,aAAa,CAAC;AACzC,eAAK,YAAY,KAAK,QAAQ;AAC9B,YAAE,sBAAsB,EAAE,MAAM,EAAE,OAAO,KAAK,uBAAuB,CAAC;AAAA,QAExE;AAAA,MACF,CAAC;AAAA,IACH;AAAA,IAEA,yBAAyB;AACvB,UAAI,UAAU,EAAE,yCAAyC;AACzD,cAAQ,MAAM;AAEd,UAAI,QAAQ,EAAE,KAAK,iCAAiC,CAAC,EAAE,SAAS,OAAO;AACvE,UAAI,CAAC,KAAK,eAAe,CAAC,KAAK,YAAY;AACzC,eAAO;AAET,WAAK,YAAY,QAAQ,CAAC,MAAM;AAC9B,cAAM,MAAM,EAAE,WAAW,EAAE,SAAS,MAAM,KAAK,OAAO,CAAC;AACvD,UAAE,OAAO,EAAE,gBAAgB,EAAE,SAAS,GAAG;AACzC,UAAE;AAAA,8FACsF,EAAE,2BAA2B,EAAE;AAAA;AAAA;AAAA,SAGpH,EAAE,SAAS,GAAG;AACjB,UAAE;AAAA,2EACmE,EAAE;AAAA;AAAA;AAAA,SAGpE,EAAE,SAAS,GAAG;AAAA,MACnB,CAAC;AACD,aAAO;AAAA,IACT;AAAA,IAEA,mCAAmC;AACjC,aAAO;AAAA;AAAA;AAAA,IAGT;AAAA,IAEA,kCAAkC,QAAQ;AACxC,UAAI,KAAK,aAAa;AAAA,MACtB;AAAA,IACF;AAAA,IAEA,gBAAgB;AACd,UAAI,KAAK;AAET,QAAE,MAAM,EAAE,GAAG,SAAS,cAAc,WAAY;AAC9C,eAAO,MAAM,kBAAkB,EAAE,IAAI,EAAE,KAAK,WAAW,CAAC;AAAA,MAC1D,CAAC;AAED,QAAE,MAAM,EAAE,GAAG,SAAS,kBAAkB,WAAY;AAClD,eAAO;AAAA,UACL,6CAA6C,EAAE,IAAI,EAAE;AAAA,YACnD;AAAA,UACF;AAAA,UACA,MAAM;AACJ,eAAG,YAAY,QAAQ,CAAC,GAAG,OAAO,WAAW;AAC3C,kBAAI,EAAE,aAAa,EAAE,IAAI,EAAE,KAAK,WAAW,GAAG;AAC5C,uBAAO,OAAO,OAAO,CAAC;AAAA,cACxB;AAAA,YACF,CAAC;AACD,cAAE,sBAAsB,EAAE,MAAM,EAAE,OAAO,GAAG,uBAAuB,CAAC;AAAA,UACtE;AAAA,QACF;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF;",
  "names": []
}
